(window["webpackJsonppini-app"]=window["webpackJsonppini-app"]||[]).push([[0],{30:function(e,t,a){e.exports=a(56)},35:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){},40:function(e,t,a){},50:function(e,t,a){},56:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(25),o=a.n(s),i=(a(35),a(5)),c=a(6),l=a(8),d=a(7),u=a(9),p=(a(36),a(29)),h=(a(37),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).onMouseDown=function(e){if(a.props.onMouseDown){var t=a.card.getBoundingClientRect();document.addEventListener("mousemove",a.moveCard),document.addEventListener("mouseup",a.stopListen),document.addEventListener("touchmove",a.moveCard),document.addEventListener("touchend",a.stopListen),e.touches?e=e.touches[0]:(e.stopPropagation(),e.preventDefault()),a.setState({visible:!0,animate:!a.state.visible,rel:{x:e.pageX-a.state.pos.x,y:e.pageY-a.state.pos.y,leftEdge:e.pageX-t.x,topEdge:e.pageY-t.y,rightEdge:window.innerWidth-t.width+(e.pageX-t.x),bottomEdge:window.innerHeight-t.height+(e.pageY-t.y)}})}},a.moveCard=function(e){e.touches?e=e.touches[0]:(e.stopPropagation(),e.preventDefault());var t=e.pageX-a.state.rel.x;t=t<0?Math.max(a.state.rel.leftEdge,e.pageX)-a.state.rel.x:Math.min(a.state.rel.rightEdge,e.pageX)-a.state.rel.x;var n=e.pageY-a.state.rel.y;n=n<0?Math.max(a.state.rel.topEdge,e.pageY)-a.state.rel.y:Math.min(a.state.rel.bottomEdge,e.pageY)-a.state.rel.y,a.setState({pos:{x:t,y:n}})},a.stopListen=function(e){document.removeEventListener("mouseup",a.stopListen),document.removeEventListener("mousemove",a.moveCard),document.removeEventListener("touchend",a.stopListen),document.removeEventListener("touchmove",a.moveCard),e=e.touches?e.changedTouches[0]:e,a.props.mouseUp&&a.props.mouseUp({x:e.pageX,y:e.pageY},a.props.card,a.card,a.props.index)},a.animationEnd=function(){a.setState({animate:!1})},a.state={pos:{x:0,y:0}},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"getSymbol",value:function(e){switch(e){case"hearts":return"\u2665";case"clubs":return"\u2663";case"spades":return"\u2660";case"diams":return"\u2666";default:return"No"}}},{key:"showCard",value:function(){this.card.classList.add("animate"),this.card.classList.remove("hidden")}},{key:"renderCorner",value:function(e,t,a){return r.a.createElement("div",{className:"small "+a},r.a.createElement("div",{className:"small-number"},e),r.a.createElement("div",{className:"small-symbol"},t))}},{key:"render",value:function(){var e=this,t="card-container"+(this.props.visible||this.state.visible?"":" hidden")+(this.state.animate?" animate":""),a=Object.assign({left:this.state.pos.x?this.state.pos.x+"px":"initial",top:this.state.pos.y?this.state.pos.y+"px":"initial",color:"r"===this.props.card.color?"#d12d36":"#333"},this.props.style);return r.a.createElement("div",{ref:function(t){return e.card=t},className:t,style:a,onTouchStart:this.onMouseDown,onMouseDown:this.onMouseDown,onAnimationEnd:this.animationEnd},r.a.createElement("div",{className:"side front"},r.a.createElement("div",{className:"small top"},r.a.createElement("div",{className:"small-number"},this.props.value),r.a.createElement("div",{className:"small-symbol"},this.getSymbol(this.props.type))),r.a.createElement("div",{className:"middle"},r.a.createElement("div",null,this.props.value)),r.a.createElement("div",{className:"small bottom"},r.a.createElement("div",{className:"small-number"},this.props.value),r.a.createElement("div",{className:"small-symbol"},this.getSymbol(this.props.type)))),r.a.createElement("div",{className:"side back"}))}},{key:"element",get:function(){return this.card}}]),t}(r.a.Component)),m=(a(38),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).state={cards:[]},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"addCard",value:function(e,t,a,n,r,s){var o=this;if(this.props.hand.addCard(e)||s){var i=function(e){return e.x+e.width/2},c=function(e){return e.y+e.height/2},l=function e(a){"trans-animate"===a.animationName&&(y&&window.clearTimeout(y),t.classList.remove("trans-animate"),t.removeEventListener("animattionend",e),o.resolve(!0),o.setState({cards:Object(p.a)(o.props.hand.cards)}))};t.addEventListener("animationend",l);var d="",u=.28;r&&(d="rotate(180deg)",u*=-1);var h=this.getPos(),m=i(h)-i(a),v=c(h)-c(a)+a.height*u*this.cardCount,f=Math.max(300,2*Math.sqrt(Math.abs(v))+350);t.style.setProperty("--tran-time",f+"ms");var y=window.setTimeout(function(){l({animationName:"trans-animate"})},f);return t.classList.add("trans-animate"),v-=.25*n,t.style.transform="translate3d(".concat(m-.25*n,"px, ").concat(v,"px, 10px) ").concat(d),new Promise(function(e,t){o.resolve=e})}return Promise.resolve(!1)}},{key:"reset",value:function(){this.setState({cards:[]})}},{key:"calcSpace",value:function(){return Math.min(.05*window.innerWidth,35)}},{key:"getPos",value:function(){return this.hand.getBoundingClientRect()}},{key:"renderHand",value:function(){if(this.props.visibleLastCard&&5===this.state.cards.length)return r.a.createElement("div",{className:"hand-result"},this.props.hand.solved.name)}},{key:"render",value:function(){var e=this,t={borderColor:this.props.round>this.state.cards.length?"green":"red"};return r.a.createElement("div",{ref:function(t){return e.hand=t},style:t,className:"hand-container"},this.state.cards.map(function(t,a){var n="translateY(".concat(28*a,"%)"),s=e.props.visibleLastCard||a<4;return r.a.createElement(h,{card:t,key:t.toString()+a,index:a,value:t.valueString,type:t.typeString,style:{transform:n},visible:s})}),this.renderHand())}},{key:"cardCount",get:function(){return this.state.cards.length}}]),t}(r.a.Component)),v=(a(39),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).modifyName=function(e){a.props.player.name=e.target.value,a.setState({name:a.props.player.name})},a.state={hands:[{},{},{},{},{}]},a.hands=[],a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){var n=this;if(e.cardData!==this.props.cardData){var r=this.props.cardData.pos,s=this.props.cardData.cardElement.getBoundingClientRect();if(this.props.ignoreCard)return!1;if(!r){for(var o=0;!this.props.player.addCard(this.props.cardData.card,o)&&o<5;)o+=1;return void this.hands[o].addCard(this.props.cardData.card,this.props.cardData.cardElement,s,this.props.cardData.cardIndex,this.props.cardData.flip,!0).then(this.props.cardData.cb)}var i=this.hands.map(function(e,t){var a=e.getPos();if(r.y>a.top&&r.y<a.bottom&&r.x<a.right&&r.x>a.left&&n.props.player.round>e.cardCount){var o=n.props.player.addCard(n.props.cardData.card,t);return e.addCard(n.props.cardData.card,n.props.cardData.cardElement,s,n.props.cardData.cardIndex,n.props.cardData.flip,o)}return Promise.resolve(!1)});Promise.all(i).then(function(e){var t=e.some(function(e){return e});n.props.cardData.cb(t)}).catch(function(e){console.log(e)})}}},{key:"reset",value:function(){this.hands.forEach(function(e){e.reset()})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"player-container"},r.a.createElement("div",{className:"player-name"+(this.props.winner&&this.props.winner===this.props.id||!this.props.winner&&this.props.currentPlayer?" active":"")},r.a.createElement("div",null,this.state.name),r.a.createElement("input",{type:"text",value:this.state.name,onChange:this.modifyName})),r.a.createElement("div",{className:"hands-container"},this.props.player.hands.map(function(t,a){return r.a.createElement(m,{ref:function(t){e.hands[a]=t},twoPlayers:e.props.twoPlayers,key:e.props.name+a,round:e.props.player.round,hand:t,visibleLastCard:e.props.visible||e.props.winner})})),this.props.winner&&this.props.winner===this.props.id?r.a.createElement("div",{className:"winner-banner"},"WINNER"):null)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return t.name?null:{name:e.name}}}]),t}(r.a.Component)),f=(a(40),a(19).CardData),y=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).releaseCard=function(e,t,n,r){a.props.moveCardToHand(e,t,n,r,function(e,t){e&&a.setState({lastCardIndex:r})})};var n=a.createCards();return a.state={cards:a.shuffle(n),lastCardIndex:n.length},a.cards=[],a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"createCards",value:function(){var e=[];return f.VALUES.forEach(function(t,a){a&&f.TYPES.forEach(function(a){e.push(new f.Card(t,a))})}),e}},{key:"shuffle",value:function(e){return e.sort(function(){return Math.random()-.5})}},{key:"sendNextCard",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.state.lastCardIndex-1;a(this.state.cards[n],this.cards[n].element,n,function(){Promise.resolve(1).then(function(){return t.setState({lastCardIndex:n})})}),e&&Promise.resolve(1).then(function(){return t.cards[n].showCard()})}},{key:"resetDeck",value:function(){this.setState({cards:this.shuffle(this.state.cards),lastCardIndex:this.state.cards.length})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"deck-container"},this.state.cards.map(function(t,a){var n="translate(-".concat(.25*a,"px, -").concat(.25*a,"px) ").concat(e.props.player2?"rotate(180deg)":"");if(a<e.state.lastCardIndex){var s=a===e.state.lastCardIndex-1;return r.a.createElement(h,{ref:function(t){return t&&(e.cards[a]=t)},card:t,key:t.toString()+a,style:{transform:n},index:a,value:t.valueString,type:t.typeString,onMouseDown:s,mouseUp:e.releaseCard})}return null}))}}]),t}(r.a.Component),g=(a(50),a(19).Board),w=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).moveCardToHand=function(e,t,n,r,s){a.setState({cardData:{pos:e,card:t,cardElement:n,cardIndex:r,flip:!a.state.player1,cb:function(e){s(e),e&&(a.twoPlayers?a.board.gameEnded()?a.checkWinner():a.setState({player1:!a.state.player1}):a.deck.sendNextCard(a.board.player2.round<5,a.addCardToPlayer2))}}})},a.addCardToPlayer2=function(e,t,n,r){a.setState({p2CardData:{pos:!1,card:e,cardElement:t,cardIndex:n,flip:!0,cb:function(){r(),a.board.gameEnded()&&a.checkWinner()}}})},a.checkWinner=function(){try{var e=a.board.winner();console.log(e),a.setState({p2Visible:!0,winner:e})}catch(t){-1===t.message.indexOf("h.qualifiesHigh is not a function")&&console.log(t.message)}},a.switchPlayers=function(){a.twoPlayers?window.location.search="":window.location.search="twoPlayers=true"},a.reset=function(){a.deck.resetDeck(),a.board=new g,a.player1.reset(),a.player2.reset(),a.setState({p2Visible:!1,winner:null})},a.state={player1:!0},a.board=new g,a.twoPlayers=e.location.search.includes("twoPlayers=true"),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"renderControls",value:function(){var e=this;return r.a.createElement("div",{className:"controls-container"},r.a.createElement("div",null,r.a.createElement("button",{className:"check-button",name:"finish",onClick:this.reset},"New Game"),r.a.createElement("button",{className:"check-button",name:"finish",onClick:this.switchPlayers},"Switch to ",this.twoPlayers?"1 Player":"2 Players")),r.a.createElement(y,{ref:function(t){return e.deck=t},player2:!this.state.player1,moveCardToHand:this.moveCardToHand,p2Card:this.addCardToPlayer2}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"board"},r.a.createElement(v,{ref:function(t){return e.player2=t},id:1,currentPlayer:!this.state.player1,name:this.board.player2.name,winner:this.state.winner,player:this.board.player2,visible:this.state.p2Visible,ignoreCard:this.twoPlayers&&this.state.player1,cardData:this.twoPlayers?this.state.cardData:this.state.p2CardData}),this.renderControls(),r.a.createElement(v,{ref:function(t){return e.player1=t},id:-1,currentPlayer:this.state.player1,name:this.board.player1.name,winner:this.state.winner,player:this.board.player1,visible:!this.twoPlayers,ignoreCard:this.twoPlayers&&!this.state.player1,cardData:this.state.cardData})),r.a.createElement("div",{className:"alert"},r.a.createElement("span",null,"Thank you for running this game on landscape")))}}]),t}(r.a.Component),b=a(26),E=a(10),C=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function k(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(b.a,null,r.a.createElement(E.a,{path:"/",component:w})),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/pini-app",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/pini-app","/service-worker.js");console.log("service window loaded"),C?(!function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):k(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):k(t,e)})}}()}},[[30,1,2]]]);
//# sourceMappingURL=main.51461633.chunk.js.map